<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head th:replace="fragments/mainHeader::header">
<meta charset="utf-8" />
<title>Order</title>
</head>

<body class="fix-header card-no-border">
	<div id="main-wrapper">
		<div th:replace="fragments/mainMenu::menu"></div>

		<div class="page-wrapper">
			<div class="container-fluid">
				<div class="alert alert-info" th:if="${status == 'success'}">
					<span class="text-info"><i class="fa fa-check-circle"></i> <span
						th:text="${message}"></span></span>
					<button type="button" class="close" data-dismiss="alert"
						aria-label="Close">
						<span aria-hidden="true">Ã—</span>
					</button>
				</div>
				<div class="row">
					<div class="col-12">
						<div class="card">
							<div class="card-body">
								<div class="row">
									<div class="col-5">
										<h4 class="card-title">Order</h4>
										<h6 class="card-subtitle">
											<a th:href="@{'/dashboard'}">Dashboard</a> / List Order
										</h6>
									</div>
									<div class="col-7" align="right">
										<a th:href="@{'/order/new'}"
											class="btn waves-effect waves-light btn-info"><i
											class="mdi mdi-plus-circle-outline"></i> Tambah Order</a> <a
											href="http://localhost:8889/export/downloads"
											class="btn waves-effect waves-light btn-success"><i
											class="mdi mdi-download"></i> Export to Excel</a>
									</div>
								</div>
								<div class="row">
									<div class="col-6">
										<div class="row">
											<div class="col-5" align="right">
												<div >
													<input readonly="readonly" type="text" class="form-control" id="startDate" placeholder="Tanggal Order Awal"/>
												</div>
											</div>
											<div class="col" style="margin-left: 20px">
												<div class="form-outline datepicker-with-filter2">
													<label for="endDate" class="form-label" >s/d</label>
												</div>
											</div>
											<div class="col-5">
												<div >
													<input readonly="readonly" type="text" class="form-control" id="endDate" placeholder="Tanggal Order Akhir"/>
												</div>
											</div>
										</div>
									</div>
									<div class="col-2" align="left">
										<button id="search"
											class="btn waves-effect waves-light btn-info"><i class=""></i>
											Cari</button>
									</div>
								</div>
								<div class="row">
									<div class="col-md-12 grid-margin stretch-card">
										<div class="card">
											<div class="card-body">
												<div class="table-responsive">
													<table id="dataTableExample" class="table">
														<thead>
															<tr>
																<th width="5%">No</th>
																<th>Nama Item</th>
																<th>Harga Item</th>
																<th>Tanggal Order</th>
																<th width="15%">Jumlah Order</th>
																<th width="15%">Total Harga</th>
																<!-- <th width="15%" class="text-center">Action</th> -->
															</tr>
														</thead>
														<tbody>
															<tr th:each="row, no : ${listOrder}">
																<td th:text="${no.index + 1}" />
																<td th:text="${row.name}" />
																<td th:text="${row.price}" />
																<td th:text="${row.orderDate}" />
																<td th:text="${row.jumlahOrder}" />
																<td th:text="${row.jumlahPrice}" />
																<!-- <td class="text-center">
																	<button type="button" class="btn btn-info btn-xs"
																		th:url="@{/order/edit/}"
																		th:data-id="${row.id}"
																		th:onclick="|location.href=this.getAttribute('url') + this.getAttribute('data-id')|">Edit</button>
																</td> -->
															</tr>
														</tbody>
													</table>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>

	</div>
	<div th:replace="fragments/mainFooter::footer"></div>
	<script>
	$(document).ready(function() {
		$("#startDate").datepicker({
			format: 'dd-mm-yyyy',
			autoclose: true,
		});
		
		$("#endDate").datepicker({
			format: 'dd-mm-yyyy',
			autoclose: true,
		});
		
		$('#search').click(function() {
			let url = new URL(window.location.href);
			url = 'http://localhost:8889';
				$.ajax({
					type : 'get',
					url : url + '/order/date?startDate='+$('#startDate').val()+"&endDate="+$('#endDate').val(),
					success : function(data) {
						
						var newRow = [];
						var table = $('#dataTableExample').DataTable().clear().draw();
						var json = JSON.parse(data);
						var number = 0;
						for(var i = 0; i < json.length; i++){
							number++;
							table.row.add([
				                    number,
				                    json[i].name,
				                    json[i].price,
				                    json[i].orderDate,
				                    json[i].jumlahOrder,
				                    json[i].jumlahPrice,
				                ]).draw();  
						}
						
					},
				});
		});
	});
	
	</script>
</body>
</html>